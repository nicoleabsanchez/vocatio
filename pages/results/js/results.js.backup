// ============================================
// VARIABLES GLOBALES
// ============================================
const BASE_FILE_SIZE = 0.5; // MB
const SIZE_PER_SECTION = 0.5; // MB por secci√≥n

// Datos aleatorios para resultados
const PERFILES = [
  'Anal√≠tico-Sistem√°tico',
  'Creativo-Innovador',
  'Social-Humanista',
  'Emprendedor-Din√°mico',
  'Cient√≠fico-Investigador',
  'Art√≠stico-Expresivo'
];

const AREAS_CONOCIMIENTO = [
  'Ingenier√≠a',
  'Tecnolog√≠a',
  'Negocios',
  'Arte y Dise√±o',
  'Ciencias Sociales',
  'Ciencias Naturales',
  'Salud',
  'Humanidades'
];

const CARRERAS_POR_AREA = {
  'Ingenier√≠a': ['Ingenier√≠a de Sistemas', 'Ingenier√≠a Industrial', 'Ingenier√≠a Mecatr√≥nica', 'Ingenier√≠a Civil', 'Ingenier√≠a Electr√≥nica'],
  'Tecnolog√≠a': ['Ciencia de Datos', 'Desarrollo de Software', 'Ciberseguridad', 'Inteligencia Artificial', 'Arquitectura de Software'],
  'Negocios': ['Administraci√≥n de Empresas', 'Marketing Digital', 'Finanzas', 'Econom√≠a', 'Comercio Internacional'],
  'Arte y Dise√±o': ['Dise√±o Gr√°fico', 'Dise√±o UX/UI', 'Arquitectura', 'Dise√±o Industrial', 'Artes Visuales'],
  'Ciencias Sociales': ['Psicolog√≠a', 'Sociolog√≠a', 'Trabajo Social', 'Antropolog√≠a', 'Comunicaci√≥n Social'],
  'Ciencias Naturales': ['Biolog√≠a', 'Qu√≠mica', 'F√≠sica', 'Matem√°ticas', 'Ciencias Ambientales'],
  'Salud': ['Medicina', 'Enfermer√≠a', 'Nutrici√≥n', 'Fisioterapia', 'Odontolog√≠a'],
  'Humanidades': ['Derecho', 'Filosof√≠a', 'Historia', 'Lenguas Modernas', 'Educaci√≥n']
};

// Variable para almacenar resultados generados
let testResults = null;

// Funci√≥n para generar resultados aleatorios
function generateRandomResults() {
  // Seleccionar perfil aleatorio
  const perfil = PERFILES[Math.floor(Math.random() * PERFILES.length)];
  
  // Generar 3 √°reas aleatorias con porcentajes
  const areasSeleccionadas = [];
  const areasDisponibles = [...AREAS_CONOCIMIENTO];
  
  for (let i = 0; i < 3; i++) {
    const index = Math.floor(Math.random() * areasDisponibles.length);
    areasSeleccionadas.push(areasDisponibles.splice(index, 1)[0]);
  }
  
  // Generar porcentajes decrecientes (primera √°rea m√°s alta)
  const porcentajes = {};
  let porcentajeBase = Math.floor(Math.random() * 21) + 70; // 70-90%
  
  areasSeleccionadas.forEach((area, index) => {
    porcentajes[area] = porcentajeBase;
    porcentajeBase = Math.max(20, porcentajeBase - Math.floor(Math.random() * 16) - 15); // Decremento de 15-30%
  });
  
  // Generar carreras recomendadas basadas en las √°reas
  const carrerasRecomendadas = [];
  areasSeleccionadas.forEach(area => {
    const carrerasArea = CARRERAS_POR_AREA[area] || [];
    if (carrerasArea.length > 0) {
      const carrera = carrerasArea[Math.floor(Math.random() * carrerasArea.length)];
      if (!carrerasRecomendadas.includes(carrera)) {
        carrerasRecomendadas.push(carrera);
      }
    }
  });
  
  // Asegurar que tengamos al menos 3 carreras
  while (carrerasRecomendadas.length < 3) {
    const todasCarreras = Object.values(CARRERAS_POR_AREA).flat();
    const carreraRandom = todasCarreras[Math.floor(Math.random() * todasCarreras.length)];
    if (!carrerasRecomendadas.includes(carreraRandom)) {
      carrerasRecomendadas.push(carreraRandom);
    }
  }
  
  return {
    perfil: perfil,
    porcentajes: porcentajes,
    areas: areasSeleccionadas,
    recomendaciones: carrerasRecomendadas.slice(0, 5),
    fecha: new Date().toLocaleDateString('es-ES', { day: 'numeric', month: 'long', year: 'numeric' })
  };
}

// Cargar datos del test vocacional
function loadTestResults() {
  // Generar resultados aleatorios cada vez que se carga la p√°gina
  testResults = generateRandomResults();
  
  // Guardar en localStorage para mantener consistencia durante la sesi√≥n
  sessionStorage.setItem('currentTestResults', JSON.stringify(testResults));
  
  // Actualizar la p√°gina con los datos generados
  updateResultsDisplay();
}

function updateResultsDisplay() {
  if (!testResults) return;
  
  // Actualizar perfil vocacional
  const perfilElement = document.querySelector('.profile-type');
  if (perfilElement) {
    perfilElement.textContent = testResults.perfil;
  }
  
  // Actualizar fecha del test
  const fechaElements = document.querySelectorAll('h2');
  fechaElements.forEach(el => {
    if (el.textContent.includes('Test Vocacional')) {
      el.textContent = `Test Vocacional - ${testResults.fecha}`;
    }
  });
  
  // Obtener porcentajes del test y ordenarlos de mayor a menor
  const affinity = testResults.porcentajes || {};
  const sortedAffinity = Object.entries(affinity)
    .sort((a, b) => b[1] - a[1])  // Ordenar descendente
    .slice(0, 3);  // Tomar top 3
  
  // Actualizar cada affinity-item con los valores ordenados
  const affinityItems = document.querySelectorAll('.affinity-item');
  affinityItems.forEach((item, index) => {
    if (sortedAffinity[index]) {
      const [categoryKey, percentage] = sortedAffinity[index];
      
      const labels = item.querySelectorAll('span');
      if (labels[0]) labels[0].textContent = categoryKey;
      if (labels[1]) labels[1].textContent = percentage + '%';
      
      // Actualizar barra de progreso
      const progressBar = item.querySelector('.progress-bar-fill');
      if (progressBar) progressBar.style.width = percentage + '%';
    }
  });
  
  // Actualizar carreras recomendadas
  if (testResults.recomendaciones && testResults.recomendaciones.length > 0) {
    const careerBadges = document.querySelector('.career-badges');
    if (careerBadges) {
      careerBadges.innerHTML = testResults.recomendaciones.map(career => 
        `<span class="career-badge">${career}</span>`
      ).join('');
    }
  }
  
  // Actualizar historial con datos aleatorios anteriores
  updateHistorySection();
}


// Funci√≥n para actualizar el historial con datos aleatorios
function updateHistorySection() {
  // Generar test anterior aleatorio
  const perfilAnterior = PERFILES[Math.floor(Math.random() * PERFILES.length)];
  
  const areasAnteriores = [];
  const areasDisponibles = [...AREAS_CONOCIMIENTO];
  for (let i = 0; i < 3; i++) {
    const index = Math.floor(Math.random() * areasDisponibles.length);
    areasAnteriores.push(areasDisponibles.splice(index, 1)[0]);
  }
  
  const porcentajesAnteriores = {};
  let porcentaje = Math.floor(Math.random() * 21) + 70;
  areasAnteriores.forEach(area => {
    porcentajesAnteriores[area] = porcentaje;
    porcentaje = Math.max(20, porcentaje - Math.floor(Math.random() * 16) - 15);
  });
  
  const carrerasAnteriores = [];
  areasAnteriores.forEach(area => {
    const carrerasArea = CARRERAS_POR_AREA[area] || [];
    if (carrerasArea.length > 0) {
      const carrera = carrerasArea[Math.floor(Math.random() * carrerasArea.length)];
      if (!carrerasAnteriores.includes(carrera)) {
        carrerasAnteriores.push(carrera);
      }
    }
  });
  
  // Actualizar el historial en el HTML
  const historyProfile = document.querySelector('.history-profile');
  if (historyProfile) {
    historyProfile.textContent = `Perfil: ${perfilAnterior}`;
  }
  
  const areasList = document.querySelector('.areas-list');
  if (areasList) {
    areasList.innerHTML = areasAnteriores.map((area, index) => 
      `<li><span class="dot"></span> ${area} (${porcentajesAnteriores[area]}%)</li>`
    ).join('');
  }
  
  const careerTags = document.querySelector('.career-tags');
  if (careerTags) {
    careerTags.innerHTML = carrerasAnteriores.slice(0, 3).map(career => 
      `<span class="career-tag">${career}</span>`
    ).join('');
  }
}

// Cargar resultados al iniciar
document.addEventListener('DOMContentLoaded', function() {
  loadTestResults();
  
  // Agregar listener al bot√≥n Personalizar
  const personalizeBtn = document.querySelector('a.btn-share[href="./results.html"]');
  if (personalizeBtn) {
    personalizeBtn.addEventListener('click', function(e) {
      e.preventDefault();
      // Navegar a us20
      window.location.href = '../careers/us20-compartir-resultados-en-redes-sociales-p1.html';
    });
  }
});

// ============================================
// FUNCIONES DE HISTORIAL
// ============================================
function saveDownloadHistory(sections, fileName) {
  const downloads = JSON.parse(localStorage.getItem('downloadHistory') || '[]');
  
  downloads.push({
    date: new Date().toISOString(),
    sections: sections,
    fileName: fileName,
    testDate: '10 de enero, 2025'
  });
  
  // Mantener solo los √∫ltimos 10 downloads
  if (downloads.length > 10) {
    downloads.shift();
  }
  
  localStorage.setItem('downloadHistory', JSON.stringify(downloads));
}

function getDownloadHistory() {
  return JSON.parse(localStorage.getItem('downloadHistory') || '[]');
}

function saveTestHistory(profile, areas, careers) {
  const tests = JSON.parse(localStorage.getItem('testHistory') || '[]');
  
  tests.push({
    date: new Date().toISOString(),
    profile: profile,
    areas: areas,
    careers: careers
  });
  
  localStorage.setItem('testHistory', JSON.stringify(tests));
}

function getTestHistory() {
  return JSON.parse(localStorage.getItem('testHistory') || '[]');
}

// ============================================
// FUNCIONES DE EMAIL
// ============================================
function validateEmail(email) {
  return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}

function sendReportByEmail() {
  const email = prompt('Ingresa tu correo electr√≥nico para recibir el reporte:');
  
  if (!email) return;
  
  if (validateEmail(email)) {
    // Simular env√≠o (en producci√≥n conectar con backend)
    alert(`‚úÖ Reporte enviado exitosamente a ${email}\n\nRevisalo en tu bandeja de entrada en los pr√≥ximos minutos.`);
    
    // Guardar en historial de emails
    const emailHistory = JSON.parse(localStorage.getItem('emailHistory') || '[]');
    emailHistory.push({ 
      email, 
      date: new Date().toISOString(),
      sections: getSelectedSections()
    });
    
    if (emailHistory.length > 20) {
      emailHistory.shift();
    }
    
    localStorage.setItem('emailHistory', JSON.stringify(emailHistory));
  } else {
    alert('‚ö†Ô∏è Por favor ingresa un correo electr√≥nico v√°lido');
  }
}

function getSelectedSections() {
  const checkboxes = document.querySelectorAll('input[name="sections"]:checked');
  return Array.from(checkboxes).map(cb => cb.value);
}

// ============================================
// FUNCIONES DE LOCALSTORAGE
// ============================================
function saveDownloadPreferences(selectedSections) {
  localStorage.setItem('downloadPreferences', JSON.stringify(selectedSections));
}

function loadDownloadPreferences() {
  const saved = localStorage.getItem('downloadPreferences');
  return saved ? JSON.parse(saved) : null;
}

// ============================================
// FUNCIONES DE VALIDACI√ìN MEJORADAS
// ============================================
function validateSections() {
  const checkboxes = document.querySelectorAll('input[name="sections"]');
  const checkedBoxes = Array.from(checkboxes).filter(cb => cb.checked);
  const errorMessage = document.getElementById('sections-error');
  const downloadBtn = document.getElementById('download-btn');
  const previewBtn = document.getElementById('preview-btn');
  
  if (checkedBoxes.length === 0) {
    errorMessage.style.display = 'flex';
    errorMessage.innerHTML = '‚ö†Ô∏è <strong style="margin-left: 0.5rem;">Selecciona al menos una secci√≥n para continuar</strong>';
    downloadBtn.disabled = true;
    downloadBtn.style.opacity = '0.5';
    downloadBtn.style.cursor = 'not-allowed';
    previewBtn.disabled = true;
    previewBtn.style.opacity = '0.5';
    previewBtn.style.cursor = 'not-allowed';
    return false;
  } else {
    errorMessage.style.display = 'none';
    downloadBtn.disabled = false;
    downloadBtn.style.opacity = '1';
    downloadBtn.style.cursor = 'pointer';
    previewBtn.disabled = false;
    previewBtn.style.opacity = '1';
    previewBtn.style.cursor = 'pointer';
    return true;
  }
}

function updateSectionsCount() {
  const checkboxes = document.querySelectorAll('input[name="sections"]');
  const checkedBoxes = Array.from(checkboxes).filter(cb => cb.checked);
  const count = checkedBoxes.length;
  
  document.getElementById('sections-count').textContent = count;
  
  return count;
}

function updateFileSize() {
  const count = updateSectionsCount();
  const estimatedSize = BASE_FILE_SIZE + (count * SIZE_PER_SECTION);
  
  document.getElementById('file-size-estimate').textContent = `${estimatedSize.toFixed(1)} MB`;
}

// ============================================
// FUNCIONES DEL MODAL
// ============================================
function openModal() {
  const modal = document.getElementById('download-modal');
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
  
  // Cargar preferencias guardadas
  const savedPreferences = loadDownloadPreferences();
  if (savedPreferences) {
    const checkboxes = document.querySelectorAll('input[name="sections"]');
    checkboxes.forEach(checkbox => {
      checkbox.checked = savedPreferences.includes(checkbox.value);
    });
  }
  
  // Actualizar contador y tama√±o
  updateFileSize();
  validateSections();
}

function closeModal() {
  const modal = document.getElementById('download-modal');
  modal.classList.remove('active');
  document.body.style.overflow = 'auto';
  
  // Resetear progreso si existe
  const progressContainer = document.getElementById('progress-container');
  const progressFill = document.getElementById('progress-fill');
  progressContainer.style.display = 'none';
  progressFill.style.width = '0%';
  
  // Mostrar botones del footer
  document.getElementById('preview-btn').style.display = 'block';
  document.getElementById('cancel-btn').style.display = 'block';
  document.getElementById('download-btn').style.display = 'block';
}

// ============================================
// FUNCIONES DE SELECCI√ìN
// ============================================
function selectAll() {
  const checkboxes = document.querySelectorAll('input[name="sections"]');
  checkboxes.forEach(checkbox => {
    checkbox.checked = true;
  });
  updateFileSize();
  validateSections();
}

function deselectAll() {
  const checkboxes = document.querySelectorAll('input[name="sections"]');
  checkboxes.forEach(checkbox => {
    checkbox.checked = false;
  });
  updateFileSize();
  validateSections();
}

// ============================================
// FUNCIONES DE DESCARGA
// ============================================
async function startDownload() {
  // Ocultar botones y mostrar progreso
  document.getElementById('preview-btn').style.display = 'none';
  document.getElementById('cancel-btn').style.display = 'none';
  document.getElementById('download-btn').style.display = 'none';
  
  const progressContainer = document.getElementById('progress-container');
  const progressFill = document.getElementById('progress-fill');
  const progressText = document.getElementById('progress-text');
  
  progressContainer.style.display = 'block';
  
  try {
    // Fase 1: Recopilando datos
    progressText.textContent = 'Recopilando datos...';
    progressFill.style.width = '20%';
    await new Promise(resolve => setTimeout(resolve, 500));
    
    // Fase 2: Generando gr√°ficos
    progressText.textContent = 'Generando gr√°ficos...';
    progressFill.style.width = '40%';
    await new Promise(resolve => setTimeout(resolve, 500));
    
    // Fase 3: Creando PDF
    progressText.textContent = 'Creando PDF...';
    progressFill.style.width = '70%';
    await generatePDFReport();
    
    // Fase 4: Finalizando
    progressText.textContent = 'Finalizando...';
    progressFill.style.width = '100%';
    await new Promise(resolve => setTimeout(resolve, 300));
    
    // √âxito
    progressText.textContent = '‚úì ¬°Descarga completada!';
    progressText.style.color = '#10b981';
    
    // Guardar preferencias
    const selectedSections = getSelectedSections();
    saveDownloadPreferences(selectedSections);
    
    // Cerrar modal despu√©s de 1.5 segundos
    setTimeout(() => {
      closeModal();
      progressText.style.color = '#666';
      document.getElementById('preview-btn').style.display = 'block';
      document.getElementById('cancel-btn').style.display = 'block';
      document.getElementById('download-btn').style.display = 'block';
    }, 1500);
    
  } catch (error) {
    console.error('Error al generar PDF:', error);
    progressText.textContent = '‚úó Error al generar el reporte';
    progressText.style.color = '#ef4444';
    progressFill.style.background = '#ef4444';
    
    setTimeout(() => {
      closeModal();
      progressText.style.color = '#666';
      progressFill.style.background = 'linear-gradient(90deg, #6c5ce7 0%, #a29bfe 100%)';
      document.getElementById('preview-btn').style.display = 'block';
      document.getElementById('cancel-btn').style.display = 'block';
      document.getElementById('download-btn').style.display = 'block';
      alert('Hubo un error al generar el reporte. Por favor, int√©ntalo de nuevo.');
    }, 2000);
  }
}

async function generatePDFReport() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  
  const selectedSections = getSelectedSections();
  const currentDate = new Date();
  const fileName = `VOCATIO_Reporte_${currentDate.toISOString().split('T')[0]}.pdf`;
  
  // Usar los datos aleatorios generados
  const datos = testResults || generateRandomResults();
  
  // Configuraci√≥n de colores
  const primaryColor = [108, 92, 231]; // #6c5ce7
  const textColor = [26, 26, 26];
  const grayColor = [102, 102, 102];
  
  let yPosition = 20;
  
  // ========== HEADER ==========
  doc.setFillColor(...primaryColor);
  doc.rect(0, 0, 210, 40, 'F');
  
  doc.setFontSize(28);
  doc.setTextColor(255, 255, 255);
  doc.setFont(undefined, 'bold');
  doc.text('VOCATIO', 105, 20, { align: 'center' });
  
  doc.setFontSize(14);
  doc.setFont(undefined, 'normal');
  doc.text('Reporte de Test Vocacional', 105, 30, { align: 'center' });
  
  yPosition = 50;
  
  // ========== FECHA ==========
  doc.setFontSize(10);
  doc.setTextColor(...grayColor);
  doc.text(`Fecha de generaci√≥n: ${datos.fecha}`, 105, yPosition, { align: 'center' });
  
  yPosition += 15;
  
  // ========== PERFIL VOCACIONAL ==========
  if (selectedSections.includes('profile')) {
    doc.setFontSize(16);
    doc.setTextColor(...primaryColor);
    doc.setFont(undefined, 'bold');
    doc.text('Tu Perfil Vocacional', 20, yPosition);
    yPosition += 10;
    
    doc.setFontSize(20);
    doc.setTextColor(...textColor);
    doc.setFont(undefined, 'bold');
    doc.text(datos.perfil, 20, yPosition);
    yPosition += 8;
    
    doc.setFontSize(10);
    doc.setTextColor(...grayColor);
    doc.setFont(undefined, 'normal');
    const profileDesc = getProfileDescription(datos.perfil);
    doc.text(profileDesc, 20, yPosition, { maxWidth: 170 });
    yPosition += 20;
  }
  
  // ========== √ÅREAS DE AFINIDAD ==========
  if (selectedSections.includes('affinity')) {
    if (yPosition > 200) {
      doc.addPage();
      yPosition = 20;
    }
    
    doc.setFontSize(16);
    doc.setTextColor(...primaryColor);
    doc.setFont(undefined, 'bold');
    doc.text('√Åreas de Mayor Afinidad', 20, yPosition);
    yPosition += 10;
    
    const sortedAreas = Object.entries(datos.porcentajes).sort((a, b) => b[1] - a[1]);
    
    sortedAreas.forEach(([area, percentage]) => {
      if (yPosition > 270) {
        doc.addPage();
        yPosition = 20;
      }
      
      doc.setFontSize(12);
      doc.setTextColor(...textColor);
      doc.setFont(undefined, 'bold');
      doc.text(`‚Ä¢ ${area}`, 25, yPosition);
      
      doc.setFont(undefined, 'normal');
      doc.setTextColor(...grayColor);
      doc.text(`${percentage}%`, 180, yPosition, { align: 'right' });
      
      // Dibujar barra de progreso
      const barWidth = 150;
      const barHeight = 6;
      const fillWidth = (barWidth * percentage) / 100;
      
      doc.setDrawColor(224, 224, 224);
      doc.setFillColor(224, 224, 224);
      doc.roundedRect(25, yPosition + 2, barWidth, barHeight, 3, 3, 'F');
      
      doc.setFillColor(...primaryColor);
      doc.roundedRect(25, yPosition + 2, fillWidth, barHeight, 3, 3, 'F');
      
      yPosition += 14;
    });
    
    yPosition += 8;
  }
  
  // ========== CARRERAS RECOMENDADAS ==========
  if (selectedSections.includes('careers')) {
    if (yPosition > 200) {
      doc.addPage();
      yPosition = 20;
    }
    
    doc.setFontSize(16);
    doc.setTextColor(...primaryColor);
    doc.setFont(undefined, 'bold');
    doc.text('Carreras Recomendadas', 20, yPosition);
    yPosition += 10;
    
    datos.recomendaciones.forEach((career, index) => {
      if (yPosition > 270) {
        doc.addPage();
        yPosition = 20;
      }
      
      doc.setFontSize(12);
      doc.setTextColor(...textColor);
      doc.setFont(undefined, 'bold');
      doc.text(`${index + 1}. ${career}`, 25, yPosition);
      
      const compatibilidad = 95 - (index * 5);
      const duracion = Math.floor(Math.random() * 2) + 4; // 4 o 5 a√±os
      
      doc.setFontSize(10);
      doc.setTextColor(...grayColor);
      doc.setFont(undefined, 'normal');
      doc.text(`Compatibilidad: ${compatibilidad}% | Duraci√≥n: ${duracion} a√±os`, 25, yPosition + 5);
      
      yPosition += 12;
    });
    
    yPosition += 8;
  }
  
  // ========== AN√ÅLISIS DETALLADO ==========
  if (selectedSections.includes('analysis')) {
    if (yPosition > 200) {
      doc.addPage();
      yPosition = 20;
    }
    
    doc.setFontSize(16);
    doc.setTextColor(...primaryColor);
    doc.setFont(undefined, 'bold');
    doc.text('An√°lisis Detallado', 20, yPosition);
    yPosition += 10;
    
    doc.setFontSize(10);
    doc.setTextColor(...textColor);
    doc.setFont(undefined, 'normal');
    
    const analysis = getAnalysisForProfile(datos.perfil);
    
    analysis.forEach(line => {
      if (yPosition > 280) {
        doc.addPage();
        yPosition = 20;
      }
      doc.text(line, 20, yPosition, { maxWidth: 170 });
      yPosition += 6;
    });
    
    yPosition += 8;
  }
  
  // ========== COMPARACI√ìN CON TESTS ANTERIORES ==========
  if (selectedSections.includes('comparison')) {
    if (yPosition > 220) {
      doc.addPage();
      yPosition = 20;
    }
    
    doc.setFontSize(16);
    doc.setTextColor(...primaryColor);
    doc.setFont(undefined, 'bold');
    doc.text('Comparaci√≥n con Tests Anteriores', 20, yPosition);
    yPosition += 10;
    
    doc.setFontSize(10);
    doc.setTextColor(...textColor);
    doc.setFont(undefined, 'normal');
    doc.text('Evoluci√≥n de tus intereses y afinidades:', 20, yPosition);
    yPosition += 8;
    
    // Generar datos comparativos aleatorios
    const areasComparacion = datos.areas.slice(0, 3);
    areasComparacion.forEach(area => {
      if (yPosition > 280) {
        doc.addPage();
        yPosition = 20;
      }
      
      const porcentajeActual = datos.porcentajes[area];
      const porcentajeAnterior = Math.max(20, porcentajeActual - Math.floor(Math.random() * 21) + 10);
      const diff = porcentajeActual - porcentajeAnterior;
      const arrow = diff > 0 ? '‚Üë' : diff < 0 ? '‚Üì' : '‚Üí';
      const color = diff > 0 ? [16, 185, 129] : diff < 0 ? [239, 68, 68] : grayColor;
      
      doc.setTextColor(...color);
      doc.text(`${area}: ${porcentajeAnterior}% ${arrow} ${porcentajeActual}%`, 25, yPosition);
      yPosition += 6;
    });
    
    yPosition += 8;
  }
  
  // ========== RECOMENDACIONES DE ESTUDIO ==========
  if (selectedSections.includes('recommendations')) {
    if (yPosition > 180) {
      doc.addPage();
      yPosition = 20;
    }
    
    doc.setFontSize(16);
    doc.setTextColor(...primaryColor);
    doc.setFont(undefined, 'bold');
    doc.text('Recomendaciones de Estudio', 20, yPosition);
    yPosition += 10;
    
    doc.setFontSize(10);
    doc.setTextColor(...textColor);
    doc.setFont(undefined, 'normal');
    
    const recommendations = getRecommendationsForAreas(datos.areas);
    
    recommendations.forEach(line => {
      if (yPosition > 280) {
        doc.addPage();
        yPosition = 20;
      }
      doc.text(line, 20, yPosition, { maxWidth: 170 });
      yPosition += 5;
    });
  }
  
  // ========== FOOTER EN TODAS LAS P√ÅGINAS ==========
  const pageCount = doc.internal.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    
    // L√≠nea decorativa
    doc.setDrawColor(...grayColor);
    doc.setLineWidth(0.5);
    doc.line(20, 285, 190, 285);
    
    // Texto del footer
    doc.setFontSize(8);
    doc.setTextColor(...grayColor);
    doc.text('Generado por VOCATIO - Tu plataforma de orientaci√≥n vocacional', 105, 290, { align: 'center' });
    doc.text(`P√°gina ${i} de ${pageCount}`, 190, 290, { align: 'right' });
  }
  
  // Guardar el PDF
  doc.save(fileName);
  
  // Guardar en historial
  saveDownloadHistory(selectedSections, fileName);
  
  return fileName;
}

// Funci√≥n para obtener descripci√≥n del perfil
function getProfileDescription(perfil) {
  const descripciones = {
    'Anal√≠tico-Sistem√°tico': 'Destacas por tu excepcional capacidad de an√°lisis l√≥gico y resoluci√≥n de problemas complejos.\nTu enfoque met√≥dico y sistem√°tico te permite descomponer situaciones complejas en componentes\nmanejables. Esta habilidad es fundamental en campos como ingenier√≠a, ciencias exactas y tecnolog√≠a.\n\nCaracter√≠sticas principales: pensamiento cr√≠tico desarrollado, alta precisi√≥n en el trabajo,\nexcelente capacidad de abstracci√≥n y orientaci√≥n a resultados medibles.',
    'Creativo-Innovador': 'Tu mente creativa y capacidad para pensar de manera divergente te permiten generar\nideas originales y soluciones innovadoras. Tienes facilidad para conectar conceptos aparentemente\ndistantes y crear propuestas disruptivas. Esta cualidad es esencial en dise√±o, artes, marketing\ny emprendimiento.\n\nCaracter√≠sticas principales: pensamiento lateral, alta adaptabilidad, capacidad de visualizaci√≥n,\ny habilidad para cuestionar el status quo.',
    'Social-Humanista': 'Posees una destacada inteligencia emocional y habilidades interpersonales que te permiten\nconectar profundamente con las personas. Tu empat√≠a y sensibilidad social te impulsan a contribuir\nal bienestar colectivo. Sobresales en campos como educaci√≥n, trabajo social, psicolog√≠a y\nrecursos humanos.\n\nCaracter√≠sticas principales: alta empat√≠a, excelente comunicaci√≥n interpersonal, capacidad de\nescucha activa y compromiso con causas sociales.',
    'Emprendedor-Din√°mico': 'Tu esp√≠ritu emprendedor y capacidad para tomar iniciativas te distinguen en entornos\ndin√°micos. Tienes facilidad para identificar oportunidades, asumir riesgos calculados y liderar\nproyectos innovadores. Destacas en negocios, gesti√≥n de proyectos y startups tecnol√≥gicas.\n\nCaracter√≠sticas principales: visi√≥n estrat√©gica, alta tolerancia al riesgo, capacidad de liderazgo,\ny orientaci√≥n a resultados comerciales.',
    'Cient√≠fico-Investigador': 'Tu curiosidad intelectual y rigor metodol√≥gico te impulsan a explorar fen√≥menos y\ncontribuir al avance del conocimiento. Disfrutas del proceso de investigaci√≥n, formulaci√≥n de\nhip√≥tesis y experimentaci√≥n. Sobresales en investigaci√≥n cient√≠fica, desarrollo tecnol√≥gico y\nacademia.\n\nCaracter√≠sticas principales: pensamiento cr√≠tico avanzado, paciencia investigativa, atenci√≥n al\ndetalle y pasi√≥n por el descubrimiento.',
    'Art√≠stico-Expresivo': 'Tu sensibilidad art√≠stica y capacidad expresiva te permiten comunicar ideas, emociones\ny conceptos a trav√©s de diversos medios creativos. Tienes una percepci√≥n est√©tica desarrollada\ny facilidad para trabajar con simbolismos y met√°foras. Destacas en artes visuales, m√∫sica,\nliteratura y dise√±o creativo.\n\nCaracter√≠sticas principales: alta sensibilidad est√©tica, capacidad de expresi√≥n emocional,\noriginalidad en la creaci√≥n y apreciaci√≥n por la belleza.'
  };
  
  return descripciones[perfil] || 'Perfil √∫nico con caracter√≠sticas especiales que te distinguen en tu √°rea de inter√©s.\nTu combinaci√≥n de habilidades te prepara para contribuir de manera significativa en tu campo elegido.';
}

// Funci√≥n para obtener an√°lisis del perfil
function getAnalysisForProfile(perfil) {
  const analisis = {
    'Anal√≠tico-Sistem√°tico': [
      'FORTALEZAS IDENTIFICADAS:',
      '',
      '‚Ä¢ Pensamiento l√≥gico y estructurado: Capacidad excepcional para descomponer problemas complejos',
      '  en componentes manejables y encontrar soluciones eficientes.',
      '',
      '‚Ä¢ Alta capacidad de an√°lisis: Habilidad para procesar grandes cantidades de informaci√≥n',
      '  e identificar patrones, tendencias y relaciones causa-efecto.',
      '',
      '‚Ä¢ Resoluci√≥n sistem√°tica de problemas: Enfoque metodol√≥gico que garantiza consistencia',
      '  y precisi√≥n en los resultados obtenidos.',
      '',
      '‚Ä¢ Habilidades matem√°ticas y cuantitativas: Facilidad para trabajar con n√∫meros, f√≥rmulas',
      '  y modelos abstractos.',
      '',
      '‚Ä¢ Atenci√≥n al detalle: Capacidad para mantener altos est√°ndares de precisi√≥n en el trabajo.',
      '',
      '√ÅREAS DE DESARROLLO RECOMENDADAS:',
      '',
      '‚Ä¢ Habilidades de comunicaci√≥n: Desarrollar la capacidad de explicar conceptos t√©cnicos',
      '  a audiencias no especializadas de manera clara y accesible.',
      '',
      '‚Ä¢ Inteligencia emocional: Fortalecer la empat√≠a y comprensi√≥n de perspectivas diferentes',
      '  en entornos colaborativos.',
      '',
      '‚Ä¢ Flexibilidad y adaptabilidad: Aprender a ajustar enfoques cuando las situaciones',
      '  requieren soluciones menos estructuradas.',
      '',
      '‚Ä¢ Gesti√≥n de proyectos: Desarrollar habilidades de liderazgo y coordinaci√≥n de equipos',
      '  multidisciplinarios.',
      '',
      'RECOMENDACIONES ESPEC√çFICAS:',
      '',
      '‚Üí Participa en proyectos colaborativos que te permitan trabajar con perfiles diversos',
      '‚Üí Toma cursos de comunicaci√≥n efectiva y presentaciones t√©cnicas',
      '‚Üí Busca oportunidades de mentor√≠a para desarrollar habilidades de liderazgo',
      '‚Üí Practica la escucha activa en reuniones y discusiones de equipo'
    ],
    'Creativo-Innovador': [
      'FORTALEZAS IDENTIFICADAS:',
      '',
      '‚Ä¢ Pensamiento divergente: Capacidad excepcional para generar m√∫ltiples soluciones',
      '  creativas a un mismo problema.',
      '',
      '‚Ä¢ Innovaci√≥n disruptiva: Habilidad para cuestionar lo establecido y proponer enfoques',
      '  revolucionarios en diferentes contextos.',
      '',
      '‚Ä¢ Adaptabilidad: Facilidad para ajustarte a cambios y encontrar oportunidades en',
      '  situaciones impredecibles.',
      '',
      '‚Ä¢ Visi√≥n futurista: Capacidad para anticipar tendencias y visualizar posibilidades',
      '  antes que otros.',
      '',
      '‚Ä¢ S√≠ntesis de ideas: Habilidad para conectar conceptos aparentemente no relacionados',
      '  y crear propuestas originales.',
      '',
      '√ÅREAS DE DESARROLLO RECOMENDADAS:',
      '',
      '‚Ä¢ Organizaci√≥n y planificaci√≥n: Desarrollar sistemas para estructurar tu creatividad',
      '  y llevar ideas a la ejecuci√≥n.',
      '',
      '‚Ä¢ Disciplina metodol√≥gica: Aprender a seguir procesos establecidos cuando la situaci√≥n',
      '  lo requiere.',
      '',
      '‚Ä¢ An√°lisis cuantitativo: Fortalecer habilidades para evaluar ideas con datos y m√©tricas',
      '  objetivas.',
      '',
      '‚Ä¢ Gesti√≥n del tiempo: Mejorar la capacidad de priorizar y cumplir con plazos establecidos.',
      '',
      'RECOMENDACIONES ESPEC√çFICAS:',
      '',
      '‚Üí Utiliza herramientas de gesti√≥n de proyectos para organizar tus ideas creativas',
      '‚Üí Aprende metodolog√≠as √°giles como Design Thinking y Scrum',
      '‚Üí Complementa tu creatividad con cursos de an√°lisis de datos',
      '‚Üí Establece rutinas que equilibren la exploraci√≥n creativa con la ejecuci√≥n pr√°ctica'
    ],
    'Social-Humanista': [
      'FORTALEZAS IDENTIFICADAS:',
      '',
      '‚Ä¢ Inteligencia emocional avanzada: Capacidad excepcional para comprender y gestionar',
      '  emociones propias y ajenas.',
      '',
      '‚Ä¢ Habilidades de comunicaci√≥n: Facilidad para expresar ideas de manera clara, emp√°tica',
      '  y persuasiva.',
      '',
      '‚Ä¢ Empat√≠a profunda: Capacidad natural para ponerte en el lugar de otros y comprender',
      '  sus perspectivas y necesidades.',
      '',
      '‚Ä¢ Construcci√≥n de relaciones: Habilidad para crear y mantener conexiones significativas',
      '  con personas diversas.',
      '',
      '‚Ä¢ Compromiso social: Motivaci√≥n genuina por contribuir al bienestar colectivo y',
      '  generar impacto positivo.',
      '',
      '√ÅREAS DE DESARROLLO RECOMENDADAS:',
      '',
      '‚Ä¢ Pensamiento anal√≠tico: Desarrollar habilidades para evaluar situaciones con datos',
      '  y evidencia objetiva.',
      '',
      '‚Ä¢ Toma de decisiones dif√≠ciles: Fortalecer la capacidad de priorizar objetivos cuando',
      '  hay conflictos de intereses.',
      '',
      '‚Ä¢ Competencias digitales: Aprender a usar tecnolog√≠a y an√°lisis de datos en contextos',
      '  sociales.',
      '',
      '‚Ä¢ Gesti√≥n de l√≠mites: Desarrollar la capacidad de establecer l√≠mites saludables en',
      '  el trabajo con personas.',
      '',
      'RECOMENDACIONES ESPEC√çFICAS:',
      '',
      '‚Üí Toma cursos de estad√≠stica aplicada a ciencias sociales',
      '‚Üí Aprende metodolog√≠as de investigaci√≥n cualitativa y cuantitativa',
      '‚Üí Desarrolla habilidades de autocuidado y gesti√≥n del estr√©s',
      '‚Üí Complementa tu formaci√≥n con conocimientos de psicolog√≠a organizacional'
    ],
    'Emprendedor-Din√°mico': [
      'FORTALEZAS IDENTIFICADAS:',
      '',
      '‚Ä¢ Visi√≥n estrat√©gica: Capacidad para identificar oportunidades de negocio y tendencias',
      '  de mercado antes que otros.',
      '',
      '‚Ä¢ Liderazgo natural: Habilidad para inspirar, motivar y dirigir equipos hacia objetivos',
      '  ambiciosos.',
      '',
      '‚Ä¢ Tolerancia al riesgo: Disposici√≥n para asumir riesgos calculados y aprender de los',
      '  fracasos.',
      '',
      '‚Ä¢ Orientaci√≥n a resultados: Enfoque en lograr metas concretas y generar valor tangible',
      '  r√°pidamente.',
      '',
      '‚Ä¢ Networking efectivo: Facilidad para crear redes de contactos estrat√©gicos y',
      '  aprovechar oportunidades.',
      '',
      '√ÅREAS DE DESARROLLO RECOMENDADAS:',
      '',
      '‚Ä¢ Gesti√≥n financiera: Profundizar en an√°lisis financiero, presupuestos y control',
      '  de costos.',
      '',
      '‚Ä¢ Paciencia estrat√©gica: Desarrollar la capacidad de esperar el momento adecuado antes',
      '  de actuar.',
      '',
      '‚Ä¢ Escucha del equipo: Fortalecer la capacidad de considerar opiniones diversas antes',
      '  de decidir.',
      '',
      '‚Ä¢ Gesti√≥n operativa: Mejorar habilidades en procesos, sistemas y operaciones del d√≠a',
      '  a d√≠a.',
      '',
      'RECOMENDACIONES ESPEC√çFICAS:',
      '',
      '‚Üí Estudia casos de √©xito y fracaso de emprendedores reconocidos',
      '‚Üí Aprende sobre lean startup y metodolog√≠as de validaci√≥n r√°pida',
      '‚Üí Desarrolla competencias en an√°lisis financiero y modelos de negocio',
      '‚Üí Busca mentores con experiencia en emprendimiento y gesti√≥n empresarial'
    ],
    'Cient√≠fico-Investigador': [
      'FORTALEZAS IDENTIFICADAS:',
      '',
      '‚Ä¢ Curiosidad intelectual: Pasi√≥n genuina por comprender fen√≥menos y buscar respuestas',
      '  a preguntas complejas.',
      '',
      '‚Ä¢ Rigor metodol√≥gico: Capacidad para dise√±ar y ejecutar investigaciones con alto nivel',
      '  de precisi√≥n cient√≠fica.',
      '',
      '‚Ä¢ Pensamiento cr√≠tico: Habilidad para cuestionar supuestos, evaluar evidencia y',
      '  formular conclusiones v√°lidas.',
      '',
      '‚Ä¢ Perseverancia investigativa: Disposici√≥n para dedicar tiempo y esfuerzo sostenido',
      '  a proyectos de largo plazo.',
      '',
      '‚Ä¢ Documentaci√≥n meticulosa: Capacidad para registrar, organizar y analizar informaci√≥n',
      '  de manera sistem√°tica.',
      '',
      '√ÅREAS DE DESARROLLO RECOMENDADAS:',
      '',
      '‚Ä¢ Comunicaci√≥n cient√≠fica: Mejorar la capacidad de divulgar hallazgos a audiencias',
      '  no especializadas.',
      '',
      '‚Ä¢ Trabajo colaborativo: Desarrollar habilidades para investigaci√≥n interdisciplinaria',
      '  y trabajo en red.',
      '',
      '‚Ä¢ Gesti√≥n de proyectos: Fortalecer competencias en planificaci√≥n de recursos y plazos',
      '  de investigaci√≥n.',
      '',
      '‚Ä¢ Aplicaci√≥n pr√°ctica: Aprender a traducir hallazgos te√≥ricos en soluciones aplicables',
      '  al mundo real.',
      '',
      'RECOMENDACIONES ESPEC√çFICAS:',
      '',
      '‚Üí Participa en congresos y publicaciones cient√≠ficas para compartir tu trabajo',
      '‚Üí Colabora con investigadores de diferentes disciplinas',
      '‚Üí Desarrolla habilidades en visualizaci√≥n de datos y storytelling cient√≠fico',
      '‚Üí Busca oportunidades de aplicar tu investigaci√≥n a problemas sociales o industriales'
    ],
    'Art√≠stico-Expresivo': [
      'FORTALEZAS IDENTIFICADAS:',
      '',
      '‚Ä¢ Sensibilidad est√©tica: Capacidad excepcional para percibir, apreciar y crear belleza',
      '  en diferentes formas.',
      '',
      '‚Ä¢ Expresi√≥n emocional: Habilidad para comunicar ideas, sentimientos y conceptos a trav√©s',
      '  de medios art√≠sticos.',
      '',
      '‚Ä¢ Originalidad creativa: Capacidad para desarrollar trabajos √∫nicos y aut√©nticos que',
      '  reflejan tu visi√≥n personal.',
      '',
      '‚Ä¢ Versatilidad expresiva: Facilidad para trabajar con diferentes t√©cnicas, estilos y',
      '  formatos creativos.',
      '',
      '‚Ä¢ Intuici√≥n art√≠stica: Capacidad para tomar decisiones creativas basadas en tu',
      '  sensibilidad y experiencia.',
      '',
      '√ÅREAS DE DESARROLLO RECOMENDADAS:',
      '',
      '‚Ä¢ Gesti√≥n profesional: Desarrollar habilidades para comercializar y gestionar tu',
      '  trabajo art√≠stico.',
      '',
      '‚Ä¢ Disciplina creativa: Establecer rutinas y m√©todos de trabajo que potencien tu',
      '  productividad art√≠stica.',
      '',
      '‚Ä¢ Conocimientos t√©cnicos: Dominar herramientas digitales y t√©cnicas contempor√°neas',
      '  relevantes a tu campo.',
      '',
      '‚Ä¢ Visi√≥n de negocio: Aprender aspectos comerciales para monetizar tu talento art√≠stico',
      '  de manera sostenible.',
      '',
      'RECOMENDACIONES ESPEC√çFICAS:',
      '',
      '‚Üí Construye un portafolio profesional que muestre tu mejor trabajo',
      '‚Üí Aprende sobre marketing digital y redes sociales para artistas',
      '‚Üí Estudia casos de artistas exitosos en tu campo',
      '‚Üí Desarrolla habilidades empresariales complementarias a tu talento art√≠stico'
    ]
  };
  
  return analisis[perfil] || [
    'FORTALEZAS IDENTIFICADAS:',
    '',
    '‚Ä¢ Habilidades √∫nicas en tu √°rea de inter√©s',
    '‚Ä¢ Capacidad de aprendizaje continuo y adaptaci√≥n',
    '‚Ä¢ Versatilidad en diferentes contextos',
    '',
    '√ÅREAS DE DESARROLLO RECOMENDADAS:',
    '',
    '‚Ä¢ Habilidades complementarias que potencien tu perfil',
    '‚Ä¢ Trabajo interdisciplinario y colaborativo',
    '‚Ä¢ Actualizaci√≥n constante en tu campo'
  ];
}

// Funci√≥n para obtener recomendaciones por √°rea
function getRecommendationsForAreas(areas) {
  const recomendacionesPorArea = {
    'Ingenier√≠a': [
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '           PLAN DE DESARROLLO PROFESIONAL - INGENIER√çA',
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '',
      'üìö CURSOS FUNDAMENTALES (Corto plazo - 0-6 meses):',
      '',
      '1. C√°lculo y √Ålgebra Lineal para Ingenier√≠a',
      '   ‚Ä¢ Plataforma: Khan Academy, MIT OpenCourseWare',
      '   ‚Ä¢ Duraci√≥n: 12 semanas | Nivel: Fundamental',
      '   ‚Ä¢ Certificaci√≥n: Disponible',
      '   - Inversion: Gratuito / $49 USD certificado',
      '',
      '2. Programacion Aplicada a la Ingenieria (Python/MATLAB)',
      '   - Plataforma: Coursera - Universidad de Michigan',
      '   - Duracion: 8 semanas | Nivel: Intermedio',
      '   - Certificacion: Si',
      '   - Inversion: $79 USD/mes',
      '',
      '3. Fundamentos de F√≠sica e Ingenier√≠a Mec√°nica',
      '   ‚Ä¢ Plataforma: edX - MIT',
      '   ‚Ä¢ Duraci√≥n: 10 semanas | Nivel: Fundamental',
      '   ‚Ä¢ Certificaci√≥n: Verificada disponible',
      '   ‚Ä¢ Inversi√≥n: Gratuito auditar / $149 USD certificado',
      '',
      'üéØ ESPECIALIZACIONES (Mediano plazo - 6-12 meses):',
      '',
      '‚Ä¢ Dise√±o Asistido por Computadora (CAD)',
      '  Herramientas: AutoCAD, SolidWorks, Fusion 360',
      '',
      '‚Ä¢ An√°lisis de Sistemas y Optimizaci√≥n',
      '  Enfoque: Modelado matem√°tico y simulaci√≥n',
      '',
      '‚Ä¢ Gesti√≥n de Proyectos de Ingenier√≠a',
      '  Metodolog√≠as: PMI, Agile for Engineering',
      '',
      'üìñ LIBROS RECOMENDADOS:',
      '',
      '‚Ä¢ "Introducci√≥n a la Ingenier√≠a" - Paul Wright',
      '‚Ä¢ "Fundamentos de Ingenier√≠a y Dise√±o" - Reynolds & Stacey',
      '‚Ä¢ "Pensamiento de Dise√±o en Ingenier√≠a" - Don Norman',
      '',
      'üéôÔ∏è PODCASTS Y RECURSOS MULTIMEDIA:',
      '',
      '‚Ä¢ Engineering Career Coach Podcast',
      '‚Ä¢ The Engineering Commons',
      '‚Ä¢ YouTube: Real Engineering, Practical Engineering',
      '',
      'üë• COMUNIDADES Y NETWORKING:',
      '',
      '‚Ä¢ IEEE (Institute of Electrical and Electronics Engineers)',
      '‚Ä¢ ASME (American Society of Mechanical Engineers)',
      '‚Ä¢ LinkedIn Groups: Engineering Professionals, Young Engineers',
      '‚Ä¢ Stack Overflow (para programaci√≥n)',
      '',
      'üèÜ CERTIFICACIONES PROFESIONALES A CONSIDERAR:',
      '',
      '‚Ä¢ FE Exam (Fundamentals of Engineering) - USA',
      '‚Ä¢ CAD Certifications (AutoCAD, SolidWorks)',
      '‚Ä¢ PMP (Project Management Professional)',
      '',
      'üí° EXPERIENCIA PR√ÅCTICA:',
      '',
      '‚Üí Participa en competencias de ingenier√≠a (rob√≥tica, dise√±o)',
      '‚Üí Realiza proyectos personales documentados en GitHub/portfolio',
      '‚Üí Busca pasant√≠as o voluntariados en empresas de ingenier√≠a',
      '‚Üí Contribuye a proyectos de c√≥digo abierto relacionados con ingenier√≠a'
    ],
    'Tecnolog√≠a': [
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '           PLAN DE DESARROLLO PROFESIONAL - TECNOLOG√çA',
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '',
      'üìö CURSOS FUNDAMENTALES (Corto plazo - 0-6 meses):',
      '',
      '1. Fundamentos de Programaci√≥n (Python o JavaScript)',
      '   ‚Ä¢ Plataforma: freeCodeCamp, Codecademy, Platzi',
      '   ‚Ä¢ Duraci√≥n: 8-10 semanas | Nivel: Principiante',
      '   ‚Ä¢ Certificaci√≥n: S√≠',
      '   ‚Ä¢ Inversi√≥n: Gratuito - $39 USD/mes',
      '',
      '2. Estructuras de Datos y Algoritmos',
      '   ‚Ä¢ Plataforma: Coursera - UC San Diego',
      '   ‚Ä¢ Duraci√≥n: 6 meses | Nivel: Intermedio-Avanzado',
      '   ‚Ä¢ Certificaci√≥n: S√≠',
      '   ‚Ä¢ Inversi√≥n: $49 USD/mes',
      '',
      '3. Desarrollo Web Full Stack',
      '   ‚Ä¢ Plataforma: The Odin Project (gratuito) o Udemy',
      '   ‚Ä¢ Duraci√≥n: 12-16 semanas | Nivel: Intermedio',
      '   ‚Ä¢ Stack: HTML, CSS, JavaScript, React, Node.js',
      '   ‚Ä¢ Inversi√≥n: Gratuito / $15-50 USD',
      '',
      '4. Bases de Datos y SQL',
      '   ‚Ä¢ Plataforma: Khan Academy, DataCamp',
      '   ‚Ä¢ Duraci√≥n: 4 semanas | Nivel: Fundamental',
      '   ‚Ä¢ Certificaci√≥n: Disponible',
      '   ‚Ä¢ Inversi√≥n: Gratuito - $25 USD/mes',
      '',
      'üéØ ESPECIALIZACIONES (Mediano plazo - 6-12 meses):',
      '',
      '‚Ä¢ Cloud Computing (AWS, Azure, Google Cloud)',
      '  Certificaci√≥n: AWS Solutions Architect, Azure Fundamentals',
      '',
      '‚Ä¢ DevOps y CI/CD',
      '  Herramientas: Docker, Kubernetes, Jenkins, Git',
      '',
      '‚Ä¢ Inteligencia Artificial y Machine Learning',
      '  Frameworks: TensorFlow, PyTorch, Scikit-learn',
      '',
      '‚Ä¢ Ciberseguridad',
      '  Certificaci√≥n: CompTIA Security+, CEH',
      '',
      'üìñ LIBROS RECOMENDADOS:',
      '',
      '‚Ä¢ "Clean Code" - Robert C. Martin',
      '‚Ä¢ "The Pragmatic Programmer" - Hunt & Thomas',
      '‚Ä¢ "Designing Data-Intensive Applications" - Martin Kleppmann',
      '‚Ä¢ "You Don\'t Know JS" (serie) - Kyle Simpson',
      '',
      'üéôÔ∏è PODCASTS Y RECURSOS:',
      '',
      '‚Ä¢ Syntax.fm (Web Development)',
      '‚Ä¢ Software Engineering Daily',
      '‚Ä¢ The Changelog',
      '‚Ä¢ YouTube: Fireship, Traversy Media, freeCodeCamp',
      '',
      'üë• COMUNIDADES Y NETWORKING:',
      '',
      '‚Ä¢ GitHub (contribuye a proyectos open source)',
      '‚Ä¢ Stack Overflow, Dev.to, Hashnode (comparte conocimiento)',
      '‚Ä¢ Discord/Slack: FreeCodeCamp, Reactiflux, Python Discord',
      '‚Ä¢ Meetups locales de tecnolog√≠a',
      '',
      'üèÜ CERTIFICACIONES PROFESIONALES:',
      '',
      '‚Ä¢ AWS Certified Solutions Architect / Developer',
      '‚Ä¢ Google Cloud Professional',
      '‚Ä¢ Microsoft Azure Fundamentals / Administrator',
      '‚Ä¢ CompTIA A+, Network+, Security+',
      '‚Ä¢ Certified Kubernetes Administrator (CKA)',
      '',
      'üí° EXPERIENCIA PR√ÅCTICA:',
      '',
      '‚Üí Construye un portafolio con 5-10 proyectos diversos',
      '‚Üí Contribuye a proyectos de c√≥digo abierto en GitHub',
      '‚Üí Participa en hackathons y competencias de programaci√≥n',
      '‚Üí Crea un blog t√©cnico o canal de YouTube compartiendo tu aprendizaje',
      '‚Üí Freelance en Upwork/Fiverr para ganar experiencia real'
    ],
    'Negocios': [
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '           PLAN DE DESARROLLO PROFESIONAL - NEGOCIOS',
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '',
      'üìö CURSOS FUNDAMENTALES (Corto plazo - 0-6 meses):',
      '',
      '1. Fundamentos de Administraci√≥n de Empresas',
      '   ‚Ä¢ Plataforma: Coursera - Wharton School',
      '   ‚Ä¢ Duraci√≥n: 8 semanas | Nivel: Fundamental',
      '   ‚Ä¢ Certificaci√≥n: S√≠',
      '   ‚Ä¢ Inversi√≥n: $49 USD/mes',
      '',
      '2. An√°lisis Financiero y Contabilidad',
      '   ‚Ä¢ Plataforma: edX - Harvard',
      '   ‚Ä¢ Duraci√≥n: 6 semanas | Nivel: Intermedio',
      '   ‚Ä¢ Certificaci√≥n: Verificada disponible',
      '   ‚Ä¢ Inversi√≥n: Gratuito auditar / $99 USD certificado',
      '',
      '3. Marketing Digital y Analytics',
      '   ‚Ä¢ Plataforma: Google Digital Garage, HubSpot Academy',
      '   ‚Ä¢ Duraci√≥n: 4-8 semanas | Nivel: Fundamental-Intermedio',
      '   ‚Ä¢ Certificaci√≥n: Gratuita',
      '   ‚Ä¢ Inversi√≥n: Gratuito',
      '',
      '4. Excel y An√°lisis de Datos para Negocios',
      '   ‚Ä¢ Plataforma: Udemy, LinkedIn Learning',
      '   ‚Ä¢ Duraci√≥n: 6 semanas | Nivel: Intermedio',
      '   ‚Ä¢ Certificaci√≥n: S√≠',
      '   ‚Ä¢ Inversi√≥n: $15-40 USD',
      '',
      'üéØ ESPECIALIZACIONES (Mediano plazo - 6-12 meses):',
      '',
      '‚Ä¢ MBA Essentials (Mini-MBA)',
      '  Plataforma: Coursera, edX',
      '',
      '‚Ä¢ Business Intelligence y Data Analytics',
      '  Herramientas: Power BI, Tableau, SQL',
      '',
      '‚Ä¢ Gesti√≥n de Proyectos',
      '  Metodolog√≠as: Agile, Scrum, Six Sigma',
      '',
      '‚Ä¢ Estrategia Empresarial',
      '  Frameworks: Blue Ocean, Porter\'s Five Forces',
      '',
      'üìñ LIBROS RECOMENDADOS:',
      '',
      '‚Ä¢ "Good to Great" - Jim Collins',
      '‚Ä¢ "The Lean Startup" - Eric Ries',
      '‚Ä¢ "Thinking, Fast and Slow" - Daniel Kahneman',
      '‚Ä¢ "Influence: The Psychology of Persuasion" - Robert Cialdini',
      '‚Ä¢ "Blue Ocean Strategy" - W. Chan Kim',
      '',
      'üéôÔ∏è PODCASTS Y RECURSOS:',
      '',
      '‚Ä¢ Harvard Business Review IdeaCast',
      '‚Ä¢ How I Built This (NPR)',
      '‚Ä¢ The Tim Ferriss Show',
      '‚Ä¢ Masters of Scale',
      '',
      'üë• COMUNIDADES Y NETWORKING:',
      '',
      '‚Ä¢ LinkedIn (fundamental para networking en negocios)',
      '‚Ä¢ C√°maras de Comercio locales',
      '‚Ä¢ BNI (Business Network International)',
      '‚Ä¢ Toastmasters (desarrollo de habilidades de presentaci√≥n)',
      '',
      'üèÜ CERTIFICACIONES PROFESIONALES:',
      '',
      '‚Ä¢ PMP (Project Management Professional)',
      '‚Ä¢ Google Analytics Certification',
      '‚Ä¢ HubSpot Inbound Marketing',
      '‚Ä¢ Lean Six Sigma Green Belt',
      '‚Ä¢ CFA (Chartered Financial Analyst) - nivel avanzado',
      '',
      'üí° EXPERIENCIA PR√ÅCTICA:',
      '',
      '‚Üí Inicia un proyecto emprendedor propio (incluso peque√±o)',
      '‚Üí Busca pasant√≠as en startups o empresas establecidas',
      '‚Üí Voluntariado en organizaciones sin fines de lucro (gesti√≥n)',
      '‚Üí Participa en competencias de casos de negocios',
      '‚Üí Asiste a conferencias y eventos de networking empresarial'
    ],
    'Arte y Dise√±o': [
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '           PLAN DE DESARROLLO PROFESIONAL - ARTE Y DISE√ëO',
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '',
      'üìö CURSOS FUNDAMENTALES (Corto plazo - 0-6 meses):',
      '',
      '1. Fundamentos de Dise√±o Visual',
      '   ‚Ä¢ Plataforma: Domestika, Skillshare, CalArts (Coursera)',
      '   ‚Ä¢ Duraci√≥n: 6-8 semanas | Nivel: Fundamental',
      '   ‚Ä¢ Temas: Color, tipograf√≠a, composici√≥n, jerarqu√≠a visual',
      '   ‚Ä¢ Inversi√≥n: $10-20 USD/mes',
      '',
      '2. Adobe Creative Suite (Photoshop, Illustrator, InDesign)',
      '   ‚Ä¢ Plataforma: Adobe, Udemy, LinkedIn Learning',
      '   ‚Ä¢ Duraci√≥n: 8-12 semanas | Nivel: Fundamental-Intermedio',
      '   ‚Ä¢ Certificaci√≥n: Adobe Certified Professional',
      '   ‚Ä¢ Inversi√≥n: $15-40 USD por curso',
      '',
      '3. UI/UX Design Fundamentals',
      '   ‚Ä¢ Plataforma: Coursera - Google UX Design',
      '   ‚Ä¢ Duraci√≥n: 6 meses | Nivel: Certificado Profesional',
      '   ‚Ä¢ Herramientas: Figma, Adobe XD',
      '   ‚Ä¢ Inversi√≥n: $49 USD/mes',
      '',
      '4. Dibujo y Anatom√≠a Art√≠stica',
      '   ‚Ä¢ Plataforma: New Masters Academy, Proko',
      '   ‚Ä¢ Duraci√≥n: Continuo | Nivel: Todos los niveles',
      '   ‚Ä¢ Certificaci√≥n: No formal',
      '   ‚Ä¢ Inversi√≥n: $35 USD/mes',
      '',
      'üéØ ESPECIALIZACIONES (Mediano plazo - 6-12 meses):',
      '',
      '‚Ä¢ Dise√±o 3D y Modelado',
      '  Software: Blender (gratuito), Cinema 4D, Maya',
      '',
      '‚Ä¢ Motion Graphics y Animaci√≥n',
      '  Herramientas: After Effects, Premiere Pro',
      '',
      '‚Ä¢ Branding e Identidad Corporativa',
      '  Enfoque: Estrategia, logo design, brand guidelines',
      '',
      '‚Ä¢ Fotograf√≠a y Edici√≥n',
      '  Software: Lightroom, Capture One',
      '',
      'üìñ LIBROS RECOMENDADOS:',
      '',
      '‚Ä¢ "The Design of Everyday Things" - Don Norman',
      '‚Ä¢ "Thinking with Type" - Ellen Lupton',
      '‚Ä¢ "Logo Design Love" - David Airey',
      '‚Ä¢ "Steal Like an Artist" - Austin Kleon',
      '‚Ä¢ "The Elements of Graphic Design" - Alex White',
      '',
      'üéôÔ∏è RECURSOS MULTIMEDIA:',
      '',
      '‚Ä¢ YouTube: The Futur, Yes I\'m a Designer, Satori Graphics',
      '‚Ä¢ Podcasts: Design Matters, 99% Invisible',
      '‚Ä¢ Behance (inspiraci√≥n y portafolio)',
      '‚Ä¢ Dribbble (comunidad de dise√±adores)',
      '',
      'üë• COMUNIDADES Y NETWORKING:',
      '',
      '‚Ä¢ Behance Network',
      '‚Ä¢ AIGA (American Institute of Graphic Arts)',
      '‚Ä¢ Dribbble Community',
      '‚Ä¢ Instagram (fundamental para dise√±adores)',
      '‚Ä¢ Design meetups locales',
      '',
      'üèÜ CERTIFICACIONES Y RECONOCIMIENTOS:',
      '',
      '‚Ä¢ Adobe Certified Professional',
      '‚Ä¢ Google UX Design Professional Certificate',
      '‚Ä¢ Nielsen Norman Group UX Certification',
      '‚Ä¢ Awwwards (reconocimiento en dise√±o web)',
      '',
      'üí° EXPERIENCIA PR√ÅCTICA:',
      '',
      '‚Üí Construye un portafolio profesional en Behance o tu propio sitio web',
      '‚Üí Toma proyectos freelance en 99designs, Fiverr, Upwork',
      '‚Üí Participa en design challenges y concursos',
      '‚Üí Redise√±a marcas ficticias como ejercicio (30 day challenge)',
      '‚Üí Colabora gratis con ONGs para ganar experiencia real',
      '‚Üí Crea contenido diario en redes sociales mostrando tu proceso'
    ],
    'Ciencias Sociales': [
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '      PLAN DE DESARROLLO PROFESIONAL - CIENCIAS SOCIALES',
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '',
      'üìö CURSOS FUNDAMENTALES (Corto plazo - 0-6 meses):',
      '',
      '1. Metodolog√≠a de la Investigaci√≥n Social',
      '   ‚Ä¢ Plataforma: Coursera - Universidad de Amsterdam',
      '   ‚Ä¢ Duraci√≥n: 8 semanas | Nivel: Intermedio',
      '   ‚Ä¢ Certificaci√≥n: S√≠',
      '   ‚Ä¢ Inversi√≥n: $49 USD/mes',
      '',
      '2. Estad√≠stica para Ciencias Sociales',
      '   ‚Ä¢ Plataforma: edX, DataCamp',
      '   ‚Ä¢ Duraci√≥n: 10 semanas | Nivel: Fundamental-Intermedio',
      '   ‚Ä¢ Herramientas: SPSS, R, Python',
      '   ‚Ä¢ Inversi√≥n: Gratuito - $39 USD/mes',
      '',
      '3. Psicolog√≠a Social y del Comportamiento',
      '   ‚Ä¢ Plataforma: Coursera - Wesleyan University',
      '   ‚Ä¢ Duraci√≥n: 6 semanas | Nivel: Fundamental',
      '   ‚Ä¢ Certificaci√≥n: S√≠',
      '   ‚Ä¢ Inversi√≥n: $49 USD/mes',
      '',
      'üéØ ESPECIALIZACIONES (Mediano plazo - 6-12 meses):',
      '',
      '‚Ä¢ An√°lisis de Pol√≠ticas P√∫blicas',
      '  Enfoque: Evaluaci√≥n de programas sociales',
      '',
      '‚Ä¢ Trabajo Social y Desarrollo Comunitario',
      '  Metodolog√≠as: Participativas, acci√≥n social',
      '',
      '‚Ä¢ Antropolog√≠a Digital y Etnograf√≠a',
      '  Herramientas: An√°lisis cualitativo, NVIVO',
      '',
      'üìñ LIBROS RECOMENDADOS:',
      '',
      '‚Ä¢ "Thinking, Fast and Slow" - Daniel Kahneman',
      '‚Ä¢ "The Social Animal" - Elliot Aronson',
      '‚Ä¢ "Capital en el Siglo XXI" - Thomas Piketty',
      '‚Ä¢ "Sapiens" - Yuval Noah Harari',
      '',
      'üéôÔ∏è PODCASTS Y RECURSOS:',
      '',
      '‚Ä¢ Hidden Brain (NPR)',
      '‚Ä¢ Freakonomics Radio',
      '‚Ä¢ The Psychology Podcast',
      '',
      'üë• COMUNIDADES:',
      '',
      '‚Ä¢ American Sociological Association',
      '‚Ä¢ Redes acad√©micas en ResearchGate',
      '‚Ä¢ Grupos de investigaci√≥n universitarios',
      '',
      'üí° EXPERIENCIA PR√ÅCTICA:',
      '',
      '‚Üí Voluntariado en ONGs de desarrollo social',
      '‚Üí Asistencia de investigaci√≥n en proyectos acad√©micos',
      '‚Üí Realiza encuestas y an√°lisis de comunidad',
      '‚Üí Publica art√≠culos en revistas o blogs especializados'
    ],
    'Ciencias Naturales': [
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '      PLAN DE DESARROLLO PROFESIONAL - CIENCIAS NATURALES',
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '',
      'üìö CURSOS FUNDAMENTALES (Corto plazo - 0-6 meses):',
      '',
      '1. Biolog√≠a Molecular y Celular',
      '   ‚Ä¢ Plataforma: edX - MIT',
      '   ‚Ä¢ Duraci√≥n: 12 semanas | Nivel: Universitario',
      '   ‚Ä¢ Certificaci√≥n: Verificada disponible',
      '   ‚Ä¢ Inversi√≥n: Gratuito auditar / $149 USD certificado',
      '',
      '2. Qu√≠mica Org√°nica y An√°lisis',
      '   ‚Ä¢ Plataforma: Khan Academy, Coursera',
      '   ‚Ä¢ Duraci√≥n: 10 semanas | Nivel: Intermedio',
      '   ‚Ä¢ Certificaci√≥n: Disponible',
      '   ‚Ä¢ Inversi√≥n: Gratuito - $49 USD',
      '',
      '3. M√©todos Cuantitativos en Ciencias',
      '   ‚Ä¢ Plataforma: DataCamp, Coursera',
      '   ‚Ä¢ Duraci√≥n: 8 semanas | Nivel: Intermedio',
      '   ‚Ä¢ Herramientas: R, Python, MATLAB',
      '   ‚Ä¢ Inversi√≥n: $25-49 USD/mes',
      '',
      'üéØ ESPECIALIZACIONES (Mediano plazo - 6-12 meses):',
      '',
      '‚Ä¢ Bioinform√°tica y Gen√≥mica',
      '  Herramientas: Python, R, Biopython',
      '',
      '‚Ä¢ Ciencias Ambientales y Sostenibilidad',
      '  Enfoque: Cambio clim√°tico, conservaci√≥n',
      '',
      '‚Ä¢ T√©cnicas de Laboratorio Avanzadas',
      '  Metodolog√≠as: Espectroscop√≠a, cromatograf√≠a',
      '',
      'üìñ LIBROS RECOMENDADOS:',
      '',
      '‚Ä¢ "The Selfish Gene" - Richard Dawkins',
      '‚Ä¢ "Silent Spring" - Rachel Carson',
      '‚Ä¢ "A Short History of Nearly Everything" - Bill Bryson',
      '‚Ä¢ "Lab Girl" - Hope Jahren',
      '',
      'üéôÔ∏è RECURSOS:',
      '',
      '‚Ä¢ Podcasts: Science Friday, Radiolab, Nature Podcast',
      '‚Ä¢ YouTube: Crash Course, Kurzgesagt, SciShow',
      '',
      'üë• COMUNIDADES:',
      '',
      '‚Ä¢ ResearchGate (red acad√©mica)',
      '‚Ä¢ Sociedades cient√≠ficas especializadas',
      '‚Ä¢ iNaturalist (ciencia ciudadana)',
      '',
      'üí° EXPERIENCIA PR√ÅCTICA:',
      '',
      '‚Üí Asistente de investigaci√≥n en laboratorios universitarios',
      '‚Üí Programas de verano en instituciones cient√≠ficas',
      '‚Üí Proyectos de ciencia ciudadana',
      '‚Üí Publicaciones en revistas cient√≠ficas'
    ],
    'Salud': [
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '           PLAN DE DESARROLLO PROFESIONAL - SALUD',
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '',
      'üìö CURSOS FUNDAMENTALES (Corto plazo - 0-6 meses):',
      '',
      '1. Anatom√≠a y Fisiolog√≠a Humana',
      '   ‚Ä¢ Plataforma: Coursera - Universidad de Michigan',
      '   ‚Ä¢ Duraci√≥n: 12 semanas | Nivel: Fundamental',
      '   ‚Ä¢ Certificaci√≥n: S√≠',
      '   ‚Ä¢ Inversi√≥n: $49 USD/mes',
      '',
      '2. Fundamentos de Salud P√∫blica',
      '   ‚Ä¢ Plataforma: edX - Johns Hopkins',
      '   ‚Ä¢ Duraci√≥n: 8 semanas | Nivel: Introductorio',
      '   ‚Ä¢ Certificaci√≥n: Verificada disponible',
      '   ‚Ä¢ Inversi√≥n: Gratuito auditar / $99 USD certificado',
      '',
      '3. Primeros Auxilios y RCP',
      '   ‚Ä¢ Plataforma: Cruz Roja, American Heart Association',
      '   ‚Ä¢ Duraci√≥n: 1-2 d√≠as | Nivel: Fundamental',
      '   ‚Ä¢ Certificaci√≥n: Oficial',
      '   ‚Ä¢ Inversi√≥n: $50-100 USD',
      '',
      'üéØ ESPECIALIZACIONES (Mediano plazo - 6-12 meses):',
      '',
      '‚Ä¢ Nutrici√≥n y Diet√©tica',
      '  Certificaci√≥n: Nutrition Coach',
      '',
      '‚Ä¢ Salud Mental y Psicolog√≠a',
      '  Enfoque: Counseling b√°sico, primeros auxilios psicol√≥gicos',
      '',
      '‚Ä¢ Administraci√≥n de Servicios de Salud',
      '  √Åreas: Gesti√≥n hospitalaria, pol√≠ticas de salud',
      '',
      'üìñ LIBROS RECOMENDADOS:',
      '',
      '‚Ä¢ "Being Mortal" - Atul Gawande',
      '‚Ä¢ "The Body" - Bill Bryson',
      '‚Ä¢ "When Breath Becomes Air" - Paul Kalanithi',
      '',
      'üéôÔ∏è RECURSOS:',
      '',
      '‚Ä¢ Podcasts: The Doctor\'s Kitchen, Medscape',
      '‚Ä¢ YouTube: Osmosis, Ninja Nerd',
      '',
      'üë• COMUNIDADES:',
      '',
      '‚Ä¢ Asociaciones profesionales de salud',
      '‚Ä¢ Foros m√©dicos y de estudiantes',
      '‚Ä¢ Voluntariado en hospitales',
      '',
      'üí° EXPERIENCIA PR√ÅCTICA:',
      '',
      '‚Üí Voluntariado en cl√≠nicas y hospitales',
      '‚Üí Shadowing de profesionales de la salud',
      '‚Üí Campa√±as de salud comunitaria',
      '‚Üí Certificaciones profesionales relevantes'
    ],
    'Humanidades': [
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '         PLAN DE DESARROLLO PROFESIONAL - HUMANIDADES',
      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
      '',
      'üìö CURSOS FUNDAMENTALES (Corto plazo - 0-6 meses):',
      '',
      '1. Filosof√≠a y Pensamiento Cr√≠tico',
      '   ‚Ä¢ Plataforma: Coursera - Universidad de Edimburgo',
      '   ‚Ä¢ Duraci√≥n: 6 semanas | Nivel: Introductorio',
      '   ‚Ä¢ Certificaci√≥n: S√≠',
      '   ‚Ä¢ Inversi√≥n: $49 USD/mes',
      '',
      '2. Historia del Arte y Cultura',
      '   ‚Ä¢ Plataforma: Khan Academy, Coursera',
      '   ‚Ä¢ Duraci√≥n: 8 semanas | Nivel: Todos los niveles',
      '   ‚Ä¢ Certificaci√≥n: Disponible',
      '   ‚Ä¢ Inversi√≥n: Gratuito - $49 USD',
      '',
      '3. Escritura Creativa y Cr√≠tica',
      '   ‚Ä¢ Plataforma: Wesleyan (Coursera), MasterClass',
      '   ‚Ä¢ Duraci√≥n: 6-8 semanas | Nivel: Intermedio',
      '   ‚Ä¢ Certificaci√≥n: S√≠',
      '   ‚Ä¢ Inversi√≥n: $49-180 USD',
      '',
      'üéØ ESPECIALIZACIONES (Mediano plazo - 6-12 meses):',
      '',
      '‚Ä¢ Estudios Culturales y Literatura Comparada',
      '  Enfoque: An√°lisis textual, teor√≠a literaria',
      '',
      '‚Ä¢ Historia y Patrimonio Cultural',
      '  √Åreas: Preservaci√≥n, museolog√≠a',
      '',
      '‚Ä¢ Ling√º√≠stica y Lenguas Extranjeras',
      '  Idiomas: Seg√∫n inter√©s personal',
      '',
      'üìñ LIBROS CL√ÅSICOS Y CONTEMPOR√ÅNEOS:',
      '',
      '‚Ä¢ "Sapiens" - Yuval Noah Harari',
      '‚Ä¢ "1984" - George Orwell',
      '‚Ä¢ "El Arte de la Guerra" - Sun Tzu',
      '‚Ä¢ "Cien A√±os de Soledad" - Gabriel Garc√≠a M√°rquez',
      '',
      'üéôÔ∏è RECURSOS:',
      '',
      '‚Ä¢ Podcasts: Philosophy Bites, The History of Philosophy',
      '‚Ä¢ YouTube: CrashCourse Philosophy, TED-Ed',
      '',
      'üë• COMUNIDADES:',
      '',
      '‚Ä¢ Clubes de lectura y escritura',
      '‚Ä¢ Sociedades filos√≥ficas',
      '‚Ä¢ Foros literarios online',
      '',
      'üí° EXPERIENCIA PR√ÅCTICA:',
      '',
      '‚Üí Escribe y publica ensayos o art√≠culos',
      '‚Üí Participa en debates y grupos de discusi√≥n',
      '‚Üí Voluntariado en museos o bibliotecas',
      '‚Üí Crea un blog o podcast sobre temas human√≠sticos'
    ]
  };
  
  const primeraArea = areas[0];
  const recs = recomendacionesPorArea[primeraArea] || [
    '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
    '           PLAN DE DESARROLLO PROFESIONAL',
    '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',
    '',
    'üìö CURSOS FUNDAMENTALES:',
    '',
    '1. Fundamentos en tu √°rea de inter√©s',
    '   ‚Ä¢ Plataforma: Coursera, edX, Udemy',
    '   ‚Ä¢ Duraci√≥n: 8-12 semanas',
    '   ‚Ä¢ Certificaci√≥n: Disponible',
    '',
    'üí° EXPERIENCIA PR√ÅCTICA:',
    '',
    '‚Üí Busca proyectos pr√°cticos relacionados',
    '‚Üí Conecta con profesionales del campo',
    '‚Üí Construye un portafolio de trabajo',
    '‚Üí Participa en comunidades especializadas'
  ];
  
  return recs;
}

function addAffinityTextVersion(doc, yPos, primaryColor, textColor, grayColor) {
  doc.setFontSize(16);
  doc.setTextColor(...primaryColor);
  doc.setFont(undefined, 'bold');
  doc.text('√Åreas de Mayor Afinidad', 20, yPos);
  yPos += 10;
  
  const areas = [
    { name: 'Ingenier√≠a', percentage: 80 },
    { name: 'Tecnolog√≠a', percentage: 60 },
    { name: 'Negocios', percentage: 20 }
  ];
  
  areas.forEach(area => {
    doc.setFontSize(12);
    doc.setTextColor(...textColor);
    doc.setFont(undefined, 'bold');
    doc.text(`‚Ä¢ ${area.name}`, 25, yPos);
    
    doc.setFont(undefined, 'normal');
    doc.setTextColor(...grayColor);
    doc.text(`${area.percentage}%`, 180, yPos, { align: 'right' });
    
    yPos += 7;
  });
  
  return yPos;
}

// ============================================
// FUNCI√ìN DE VISTA PREVIA MEJORADA
// ============================================
function showPreview() {
  const checkboxes = document.querySelectorAll('input[name="sections"]:checked');
  
  if (checkboxes.length === 0) {
    alert('‚ö†Ô∏è Selecciona al menos una secci√≥n para ver la vista previa');
    return;
  }
  
  const selectedSections = Array.from(checkboxes).map(cb => {
    const label = document.querySelector(`label[for="${cb.id}"]`);
    const title = label.querySelector('.checkbox-label').textContent;
    const description = label.querySelector('.section-description').textContent;
    return { title, description };
  });
  
  // Crear modal de vista previa
  const previewModal = document.createElement('div');
  previewModal.className = 'modal-overlay active';
  previewModal.id = 'preview-modal-temp';
  
  const count = selectedSections.length;
  const size = (BASE_FILE_SIZE + (count * SIZE_PER_SECTION)).toFixed(1);
  
  previewModal.innerHTML = `
    <div class="modal-content" style="max-width: 700px;">
      <div class="modal-header">
        <h2>üìÑ Vista Previa del Reporte</h2>
        <button class="modal-close" onclick="document.getElementById('preview-modal-temp').remove()">&times;</button>
      </div>
      <div class="modal-body">
        <div style="background: linear-gradient(135deg, #6c5ce7, #a78bfa); padding: 2rem; border-radius: 12px; color: white; text-align: center; margin-bottom: 1.5rem;">
          <h3 style="margin: 0 0 0.5rem 0; font-size: 1.5rem;">VOCATIO</h3>
          <p style="margin: 0; opacity: 0.9;">Reporte de Test Vocacional</p>
        </div>
        
        <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem;">
          <h3 style="margin: 0 0 1rem 0; color: #1a1a1a; font-size: 1.125rem;">Contenido del reporte:</h3>
          <div style="display: flex; flex-direction: column; gap: 1rem;">
            ${selectedSections.map((section, index) => `
              <div style="display: flex; gap: 1rem; align-items: start;">
                <div style="width: 32px; height: 32px; background: #6c5ce7; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">
                  ${index + 1}
                </div>
                <div>
                  <div style="font-weight: 600; color: #1a1a1a; margin-bottom: 0.25rem;">${section.title}</div>
                  <div style="color: #666; font-size: 0.875rem;">${section.description}</div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
          <div style="background: #e8f5e9; padding: 1rem; border-radius: 8px; text-align: center;">
            <div style="font-size: 0.875rem; color: #2e7d32; margin-bottom: 0.25rem;">Secciones incluidas</div>
            <div style="font-size: 1.5rem; font-weight: 700; color: #1b5e20;">${count}</div>
          </div>
          <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; text-align: center;">
            <div style="font-size: 0.875rem; color: #1565c0; margin-bottom: 0.25rem;">Tama√±o estimado</div>
            <div style="font-size: 1.5rem; font-weight: 700; color: #0d47a1;">${size} MB</div>
          </div>
        </div>
        
        <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
          <div style="font-weight: 600; color: #856404; margin-bottom: 0.5rem;">üí° Nota importante:</div>
          <div style="color: #856404; font-size: 0.875rem;">
            El PDF incluir√° gr√°ficos visuales, an√°lisis detallado y recomendaciones personalizadas.
            Este es un documento profesional que podr√°s compartir con orientadores o instituciones educativas.
          </div>
        </div>
        
        <div style="display: flex; gap: 1rem; justify-content: flex-end;">
          <button onclick="document.getElementById('preview-modal-temp').remove()" class="btn btn-secondary">Cerrar</button>
          <button onclick="document.getElementById('preview-modal-temp').remove(); document.getElementById('download-form').dispatchEvent(new Event('submit', { cancelable: true }))" class="btn btn-primary">Descargar ahora</button>
        </div>
      </div>
    </div>
  `;
  
  document.body.appendChild(previewModal);
  
  // Cerrar al hacer clic fuera
  previewModal.addEventListener('click', (e) => {
    if (e.target === previewModal) {
      previewModal.remove();
    }
  });
}

// ============================================
// INICIALIZACI√ìN
// ============================================
document.addEventListener('DOMContentLoaded', function() {
  // Evento para abrir modal
  const downloadButton = document.querySelector('.btn-download');
  if (downloadButton) {
    downloadButton.addEventListener('click', function(e) {
      e.preventDefault();
      openModal();
    });
  }
  
  // Evento para compartir por WhatsApp
  const shareButton = document.querySelector('.btn-share');
  if (shareButton) {
    shareButton.addEventListener('click', function(e) {
      e.preventDefault();
      showShareOptions();
    });
  }
  
  // Guardar datos del test actual en historial (simulaci√≥n)
  const testData = {
    profile: 'Anal√≠tico-Sistem√°tico',
    areas: {
      'Ingenier√≠a': 80,
      'Tecnolog√≠a': 60,
      'Negocios': 20
    },
    careers: ['Ingenier√≠a de Sistemas', 'Ciencia de Datos', 'Ingenier√≠a Industrial']
  };
  saveTestHistory(testData.profile, testData.areas, testData.careers);
  
  // Evento para cerrar modal (X)
  const closeButton = document.querySelector('.modal-close');
  if (closeButton) {
    closeButton.addEventListener('click', closeModal);
  }
  
  // Evento para cerrar modal (overlay)
  const modalOverlay = document.getElementById('download-modal');
  if (modalOverlay) {
    modalOverlay.addEventListener('click', function(e) {
      if (e.target === modalOverlay) {
        closeModal();
      }
    });
  }
  
  // Eventos para checkboxes
  const checkboxes = document.querySelectorAll('input[name="sections"]');
  checkboxes.forEach(checkbox => {
    // Evento change para actualizar contador y validar
    checkbox.addEventListener('change', function() {
      updateFileSize();
      validateSections();
    });
    
    // Evento blur para validaci√≥n adicional
    checkbox.addEventListener('blur', function() {
      validateSections();
    });
  });
  
  // Bot√≥n seleccionar todo
  const selectAllBtn = document.getElementById('select-all-btn');
  if (selectAllBtn) {
    selectAllBtn.addEventListener('click', selectAll);
  }
  
  // Bot√≥n deseleccionar todo
  const deselectAllBtn = document.getElementById('deselect-all-btn');
  if (deselectAllBtn) {
    deselectAllBtn.addEventListener('click', deselectAll);
  }
  
  // Bot√≥n vista previa
  const previewBtn = document.getElementById('preview-btn');
  if (previewBtn) {
    previewBtn.addEventListener('click', showPreview);
  }
  
  // Bot√≥n cancelar
  const cancelBtn = document.getElementById('cancel-btn');
  if (cancelBtn) {
    cancelBtn.addEventListener('click', closeModal);
  }
  
  // Evento submit del formulario
  const downloadForm = document.getElementById('download-form');
  if (downloadForm) {
    downloadForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Validaci√≥n completa antes de descargar
      if (!validateSections()) {
        return;
      }
      
      // Iniciar proceso de descarga
      startDownload();
    });
  }
  
  console.log('Results.js inicializado correctamente');
  console.log('Sistema de descarga personalizada listo');
});

// ============================================
// FUNCIONES DE COMPARTIR MEJORADAS
// ============================================
function showShareOptions() {
  const shareModal = document.createElement('div');
  shareModal.className = 'modal-overlay active';
  shareModal.id = 'share-modal-temp';
  
  shareModal.innerHTML = `
    <div class="modal-content" style="max-width: 500px;">
      <div class="modal-header">
        <h2>Compartir Resultados</h2>
        <button class="modal-close" onclick="document.getElementById('share-modal-temp').remove()">&times;</button>
      </div>
      <div class="modal-body">
        <p style="color: #666; margin-bottom: 1.5rem;">Elige c√≥mo deseas compartir tus resultados:</p>
        
        <div style="display: flex; flex-direction: column; gap: 1rem;">
          <button onclick="shareViaWhatsApp(); document.getElementById('share-modal-temp').remove();" class="btn btn-primary" style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
            </svg>
            WhatsApp
          </button>
          
          <button onclick="sendReportByEmail(); document.getElementById('share-modal-temp').remove();" class="btn btn-secondary" style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
              <polyline points="22,6 12,13 2,6"></polyline>
            </svg>
            Enviar por Email
          </button>
          
          <button onclick="copyLinkToClipboard(); document.getElementById('share-modal-temp').remove();" class="btn btn-secondary" style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
              <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
            </svg>
            Copiar enlace
          </button>
        </div>
      </div>
    </div>
  `;
  
  document.body.appendChild(shareModal);
  
  shareModal.addEventListener('click', (e) => {
    if (e.target === shareModal) {
      shareModal.remove();
    }
  });
}

function shareViaWhatsApp() {
  const message = `VOCATIO - Mis Resultados

Test Vocacional - 10 de enero, 2025

*Perfil Vocacional:* Anal√≠tico-Sistem√°tico

*√Åreas de Mayor Afinidad:*
‚Ä¢ Ingenier√≠a: 80%
‚Ä¢ Tecnolog√≠a: 60%
‚Ä¢ Negocios: 20%

*Carreras Recomendadas:*
1. Ingenier√≠a de Sistemas
2. Ciencia de Datos
3. Ingenier√≠a Industrial
4. Arquitectura de Software
5. Ingenier√≠a Mecatr√≥nica

Descubre tu vocaci√≥n con VOCATIO - Tu plataforma de orientaci√≥n vocacional

üîó Visita: https://nicoleabsanchez.github.io/vocatio/`;

  const encodedMessage = encodeURIComponent(message);
  const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
  
  window.open(whatsappUrl, '_blank');
  console.log('Compartir por WhatsApp activado');
}

function copyLinkToClipboard() {
  const link = window.location.href;
  
  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(link).then(() => {
      alert('‚úì Enlace copiado al portapapeles');
    }).catch(err => {
      console.error('Error al copiar:', err);
      fallbackCopyTextToClipboard(link);
    });
  } else {
    fallbackCopyTextToClipboard(link);
  }
}

function fallbackCopyTextToClipboard(text) {
  const textArea = document.createElement('textarea');
  textArea.value = text;
  textArea.style.position = 'fixed';
  textArea.style.top = '0';
  textArea.style.left = '0';
  textArea.style.opacity = '0';
  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();
  
  try {
    document.execCommand('copy');
    alert('‚úì Enlace copiado al portapapeles');
  } catch (err) {
    console.error('Error al copiar:', err);
    alert('No se pudo copiar el enlace');
  }
  
  document.body.removeChild(textArea);
}

